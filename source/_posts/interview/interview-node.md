---
title: 面试——node篇
date: 2020-12-30 16:25:28
tags: 
  - 面试
  - node
type: 面试                                                                 # 标签、分类
description:  Vue是一套用于构建用户界面的渐进式框架。
top_img: https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=4104387483,4024841696&fm=26&gp=0.jpg             # 文章的顶部图片
aside: true                                                                         # 展示文章侧边栏(默认为true)
categories: 
  - 面试
  - node                                                                 # 文章标签
cover: https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=4104387483,4024841696&fm=26&gp=0.jpg                 # 文章的缩略图（用在首页）
---

# Node 异步单线程原理？（Nodejs如何实现高并发的）
  0. Node.js 实现异步的核心是事件，也就是说，它把每一个任务都当成 事件 来处理，然后通过 Event Loop 模拟了异步的效果
  1. 每个Node.js进程只有一个主线程在执行程序代码，形成一个执行栈（execution context stack)
  2. 主线程之外，还维护了一个"事件队列"（Event queue）。当用户的网络请求或者其它的异步操作到来时，node都会把它放到Event Queue之中，此时并不会立即执行它，代码也不会被阻塞，继续往下走，直到主线程代码执行完毕。
  3. 主线程代码执行完毕完成后，然后通过Event Loop，也就是事件循环机制，开始到Event Queue的开头取出第一个事件，从线程池中分配一个线程去执行这个事件，接下来继续取出第二个事件，再从线程池中分配一个线程去执行，然后第三个，第四个。主线程不断的检查事件队列中是否有未执行的事件，直到事件队列中所有事件都执行完了，此后每当有新的事件加入到事件队列中，都会通知主线程按顺序取出交EventLoop处理。当有事件执行完毕后，会通知主线程，主线程执行回调，线程归还给线程池。
---

# Node 如何多进程？
  * 我们都知道 Node.js 是以单线程的模式运行的，但它使用的是事件驱动来处理并发，这样有助于我们在多核 cpu 的系统上创建多个子进程，从而提高性能。
---

# node.js中进程通信
---

# express实现原理
  * express的所有服务端逻辑处理都是通过中间件来实现的，中间件是一个函数，而app.use（）方法就是去装载这些函数,并放入一个数组中。

  * 当前端一个请求传到服务器的时候，首先会经过request，然后是一系列的服务端处理，也就是中间件处理，存放于数组中的中间件采用后进先出的栈模式处理请求，最先入栈的中间件处理完请求之后，通过next将执行权交给第二个入栈的中间件，依次类推，直到数组末尾或者中间某个中间件没有调用next()函数，最后再将处理完的结果response回前端。
---

# node的事件循环
  * Node.js 在主线程里维护了一个事件队列，当接到请求后，就将该请求作为一个事件放入这个队列中，然后继续接收其他请求。当主线程空闲时(没有请求接入时)，就开始循环事件队列，检查队列中是否有要处理的事件，这时要分两种情况：如果是非 I/O 任务，就亲自处理，并通过回调函数返回到上层调用；如果是 I/O 任务，就从 线程池 中拿出一个线程来处理这个事件，并指定回调函数，然后继续循环队列中的其他事件。
  * 当线程中的 I/O 任务完成以后，就执行指定的回调函数，并把这个完成的事件放到事件队列的尾部，等待事件循环，当主线程再次循环到该事件时，就直接处理并返回给上层调用。 这个过程就叫 事件循环。
---

# node的事件循环和浏览器的有什么区别吗？
  1. Node.js 的事件循环分为6个阶段
  2. 浏览器和Node 环境下，microtask 任务队列的执行时机不同
  3. Node.js中，microtask 在事件循环的各个阶段之间执行
  4. 浏览器端，microtask 在事件循环的 macrotask 执行完之后执行
  5. 递归的调用process.nextTick()会导致I/O starving，官方推荐使用setImmediate()
---

# express 框架的核心特性
  1. 可以设置中间件来响应 HTTP 请求。
  2. 定义了路由表用于执行不同的 HTTP 请求动作。
  3. 可以通过向模板传递参数来动态渲染 HTML页面
---

# express框架和Koa的区别
  * 编程模型不同：Express的中间件是线型的，Koa 的中间件是U型的（洋葱模型）
  * 对语言特性的使用不同：express使用回调函数next()，koa v2.x 使用async/await 语法
---

# koa-body原理
  * koa-body中间件作用是将post等请求的请求体携带的数据解析到ctx.request.body中
  * 原理：先用type-is这个包判断出请求的数据类型，然后根据不同类型用co-body(请求体解析)和formidable(数据类型是multipart，文件上传解析)来解析，拿到解析结果以后放到ctx.request.body或者ctx.request.files里面
---

# node中的require加载文件的顺序
  1. 如果some_module 是一个核心模块，直接加载，结束。
  2. 如果some_module以“ / ”、“ ./ ”或“ …/ ”开头，按路径加载 some_module，结束。
  3. 假设当前目录为 current_dir，按路径加载 current_dir/node_modules/some_module。
    * 如果加载成功，结束
    * 如果加载失败，令current_dir为其父目录。
    * 重复这一过程，直到遇到根目录，抛出异常，结束。
---

# node模块分几类
内置模块、自定义模块、第三方模块
---
    
# 说一下你对 generator 的了解？
---

# generator的原理
  * Generator 是 ES6 中新增的语法，和 Promise ⼀样，都可以⽤来异步编程。加上 * 的函数执⾏后拥有了 next 函数，也就是说 函数执⾏后返回了⼀个对象。每次调⽤ next 函数可以继续执⾏被暂停的代 码。
---

# node 如何捕捉错误，内存泄漏怎么排查；
---

# node线程模型
---

# node怎么启动
---

# koa洋葱模型
  
---

# 如何封装中间件
  > 在进入具体的业务处理之前，先让过滤器处理
---

# 介绍一下你对中间件的理解
---

# 使⽤过的koa2中间件
  * koa-router: 提供了全面的路由功能
  * koa-bodyparser: 解析请求体的中间件
  * koa-views: 视图模板渲染中间件，支持ejs, nunjucks等众多模板引擎
  * koa-jwt: 使用JWT认证HTTP`请求。
---

# 负载均衡说一下
  > 当系统面临大量用户访问,负载过高的时候,通常会使用增加服务器数量来进行横向扩展,使用集群和负载均衡提高整个系统的处理能力
---

# 如果要实现负载均衡，需要注意什么
---

# 如果 Node 要在后端更新文件，如何安全更新
---

# 进程守护需要注意什么
---

# node开启多线程怎么做，PM2了解吗
  * 使用cluster模块。单个 Node.js 实例运行在单个线程中。 为了充分利用多核系统，有时需要启用一组 Node.js 进程去处理负载任务。cluster 模块可以创建共享服务器端口的子进程。
  * 介绍: PM2是node进程管理工具，可以利用它来简化很多node应用管理的繁琐任务，如性能监控、自动重启、负载均衡等，而且使用非常简单
    - 主要特性：
      - 启动多子进程，充分使用cpu
      - 子进程之间负载均衡
      - 0秒重启
      - 界面友好
      - 提供进程交互接口
---

# pm2依据什么重启服务
  > pm2采用心跳检测查看子进程是否出在活跃状态。每隔数秒向子进程发送心跳包，子进程如果不回复，那么调用kill杀死这个进程，然后再重新cluster.fork()一个新的进程，子进程可以监听错误事件，这时候可以发送消息给主进程，请求杀死自己，并且主进程此时重新调用cluster.fork一个新的子进程
---

# pm2 原理
---

# pm2怎么做进程管理，进程挂掉怎么处理
---

# 不用pm2怎么做进程管理
---

# 介绍下node核心模块(主要是stream)
---

# 什么是 IOC 机制，如何在 Node 里面使用
---

# NPM的作用是什么
node的包管理工具
---

# npm的简单指令
---

# export和module.exports有什么区别？哪些代码会放在module.exports里？export有哪几种导出方式？加载时间不一样
  * 区别：
    - exports返回的是模块函数，module.exports返回的是模块对象本身，返回的是一个类
    - exports的方法可以直接调用，module.exports需要new对象之后才可以调用
---

# export和export default的区别
  1. export default只能导出一个变量，而export可以导出多个
  2. export 导出的变量可以修改，export default则不行
  3. 语法差异，export const xxx = xxx是合法语句，但是export default则不可以
---

# node的 nextTick 和 vue的 nextTick 区别
---

# V8垃圾回收机制
---

# 什么是Nodejs，为什么要使用，有什么特点？
  * 概念：Node是一个基于Chrome JavaScript运行时建立的平台， 用于方便地搭建响应速度快、易于扩展的网络应用
  * 作为web前端开发人员需要了解一门后台语言，对于前端开发人员nodejs 更容易上手
  * 特点：
    1. RESTful API
    2. 单线程
    3. 非阻塞IO
    4. V8虚拟机
    5. 事件驱动
---

# 什么是错误优先的回调函数
NodeJS 通常使用回调模式，如果在执行期间发生错误，会把错误作为回调的第一个参数传递到回调函数中
---

# 说一下对端口的理解
通过“IP地址+端口号”来区分不同的服务的
---

# 什么是域名
域名（英语：Domain Name），又称网域，是由一串用点分隔的名字组成的Internet上某一台计算机或计算机组的名称，用于在数据传输时对计算机的定位标识（有时也指地理位置）
---

# 说一下对ip的理解
IP是TCP/IP体系中的网络层协议,IP地址是用来识别网络上的设备，IP地址是由网络地址与主机地址两部分所组成
---

# Node原生api错误处理有了解吗？说一下
---

# 介绍下Node EventEmitter
---

# node如何进行跨域通信
  1. 使用socket.io
  2. 使用cors，设置node服务器，配置Access-control-allow-origin
---

# 介绍下node文件查找优先级
---

# node如何做错误监控(运行时与其他)。如何生成日志，日志等级
  * 如何监控
    1. 错误类型
      * 当出现语法错误或运行时错误时，会触发js错误
      * 当试图访问一个不存在或没有访问的文件时，会触发系统错误
      * 除了系统错误和js错误外，用户还可以自定义错误
    2. 监控异常日志
      * 异常日志同城用来记录那些意外发生的异常错误。通过日志的记录，可以根据异常信息，去定位bug穿的具体位置，以快速修复问题
  * 如何生成日志
    * 使用日志中间件，日志中间件可以将关键数据按一定格式输出到日志文件中。如:
      - log4j
      - connect

  * 日志等级
    - console.log: 普通日志
    - console.info: 普通信息
    - console.warn: 警告信息
    - console.error: 错误信息
---

# 是否了解glob，glob是如何处理文件的，业界是否还有其他解决方案
---
